# Callsign Management V1 - 관리자 통합 대시보드 계획서

> **Summary**: 항공교통본부 관리자를 위한 유사호출부호 통합 관리 페이지 구축 - 임시 메뉴로 시작해서 검증 후 메인 메뉴로 전환
>
> **Project**: KATC1 항공사 유사호출부호 경고시스템 - Phase 6 UI/UX 개선
> **Version**: 1.0.0
> **Date**: 2026-02-22
> **Status**: Planning Phase
> **Feature Name**: callsign-management-v1

---

## 1. 개요 (Overview)

### 1.1 목표 (Goal)

항공교통본부 관리자가 **한 곳에서** 유사호출부호 데이터와 항공사 조치 현황을 통합 관리하는 대시보드 구축:
- ✅ 유사호출부호 업로드 → 항공사에 즉시 공개
- ✅ 항공사별 조치 현황 실시간 추적
- ✅ 통계 기반 모니터링 (조치율, 위험도, 상태 분포)
- ✅ 모든 웹사이트 관리도 함께 수행 가능

### 1.2 배경 (Background)

**현재 상태:**
- 상단 메뉴: "유사호출부호 관리" (기존)
- 기능 산재: 조치 등록 + 항공사 통계 + 엑셀 업로드 분산
- 관리자 UX: 여러 페이지 왕복 필요 → 비효율

**개선 전략:**
1. **임시 메뉴** "유사호출부호1" 생성 (프로토타입)
2. **왼쪽 메뉴**: "엑셀 업로드" 섹션 (기존 기능 이동)
3. **탭 방식 대시보드**: 전체현황 / 항공사조치 / 통계
4. **검증 후** 기존 메뉴 대체

### 1.3 사용자 역할 (User Personas)

**관리자 (항공교통본부)**
- 유사호출부호 데이터 업로드
- 항공사 조치 현황 모니터링
- 통계 기반 성과 분석
- 홈페이지 관리 동시 수행

---

## 2. 범위 (Scope)

### 2.1 In Scope (포함 사항)

#### UI 구조
- [ ] 상단 메뉴: "유사호출부호1" 추가 (ROUTES.CALLSIGN_MGT_V1)
- [ ] 왼쪽 사이드 메뉴: "엑셀 업로드" 섹션 (기존에서 이동)
- [ ] 탭 레이아웃 (3개 탭):
  - 전체현황 (Overview)
  - 항공사조치 (Actions)
  - 통계 (Statistics)

#### 전체현황 탭
- [ ] 유사호출부호 등록 현황 카드
  - 총 호출부호 수
  - 위험도별 분포 (매우높음, 높음, 낮음)
  - 상태별 분포 (진행중, 완료)
- [ ] 호출부호 목록 테이블 (최신 20개)
  - 항공사, 호출부호 쌍, 위험도, 상태, 등록일
  - 필터: 항공사, 위험도, 상태

#### 항공사조치 탭
- [ ] 항공사별 조치 현황 테이블
  - 항공사명, 총 호출부호, 조치율(완료/전체), 대기중, 진행중, 완료
  - 색상: 조치율 녹색/황색/적색 (80%+ / 50-80% / <50%)
  - 정렬: 조치율 낮은 순 (우선 순위 높음)
- [ ] 호출부호-조치 매핑 (드릴다운)
  - 항공사 선택 → 해당 호출부호 + 조치 현황
- [ ] Excel 내보내기: 현황 데이터 다운로드

#### 통계 탭
- [ ] KPI 카드 (4개)
  - 총 호출부호, 미조치(pending), 진행중, 완료
- [ ] 차트 (2개)
  - 위험도별 현황 (막대 차트)
  - 항공사별 조치율 (가로 막대)
- [ ] 통계 테이블
  - 항공사별: 호출부호 수, 조치율, 평균 대응시간
  - 정렬/필터: 조치율, 항공사명

#### 왼쪽 사이드 메뉴
- [ ] "엑셀 업로드" 섹션
  - 파일 드래그 앤 드롭
  - 처리 진행률
  - 업로드 결과 요약 (삽입/수정/실패)
  - 업로드 이력 (최근 5개)

### 2.2 Out of Scope (제외 사항)

- 호출부호 수동 CRUD (엑셀 업로드만 사용)
- 알림/이메일 기능 (향후 단계)
- 고급 필터 (날짜 범위, 다중 필터)
- 모바일 반응형 (데스크톱 관리자용)
- 다국어 지원

---

## 3. 요구사항 (Requirements)

### 3.1 기능 요구사항 (Functional Requirements)

| ID | 기능 | 우선순위 | 상태 |
|-----|------|---------|------|
| FR-01 | 상단 메뉴에 "유사호출부호1" 추가 | Must | ⏳ Design |
| FR-02 | 왼쪽 메뉴에 "엑셀 업로드" 섹션 추가 | Must | ⏳ Design |
| FR-03 | 전체현황 탭: 호출부호 등록 현황 카드 (총수, 위험도별, 상태별) | Must | ⏳ Design |
| FR-04 | 전체현황 탭: 호출부호 목록 테이블 (필터/페이지) | Should | ⏳ Design |
| FR-05 | 항공사조치 탭: 항공사별 현황 테이블 (조치율 색상 코딩) | Must | ⏳ Design |
| FR-06 | 항공사조치 탭: 호출부호-조치 매핑 드릴다운 | Should | ⏳ Design |
| FR-07 | 통계 탭: KPI 카드 (4개 지표) | Must | ⏳ Design |
| FR-08 | 통계 탭: 위험도별/항공사별 차트 | Should | ⏳ Design |
| FR-09 | 엑셀 업로드 UI: 드래그 앤 드롭 | Must | ⏳ Design |
| FR-10 | 엑셀 업로드 결과: 요약 및 이력 | Must | ⏳ Design |
| FR-11 | Excel 내보내기: 현황 데이터 다운로드 | Should | ⏳ Design |
| FR-12 | 엑셀 업로드 후 항공사에 즉시 공개 | Must | ⏳ Design |

### 3.2 기술 요구사항 (Non-Functional Requirements)

| 카테고리 | 기준 | 측정 방법 |
|---------|------|---------|
| 성능 | 페이지 로드 < 2초 | Lighthouse |
| 성능 | 데이터 로드 < 500ms | Network tab |
| 보안 | Admin role 검증 | Token check |
| 신뢰성 | 데이터 정확도 99%+ | 통계 검증 |
| 사용성 | 한국어 UI 완전 지원 | UI 리뷰 |
| 빌드 | TypeScript 에러 0개 | `npm run build` |

---

## 4. 화면 설계 (Screen Design)

### 4.1 페이지 구조

```
/admin/callsign-mgmt-v1
├─ 왼쪽 사이드바
│  └─ 엑셀 업로드 섹션
│     ├─ 파일 업로드 영역 (드래그&드롭)
│     ├─ 처리 진행률
│     ├─ 업로드 결과 요약 카드
│     └─ 업로드 이력 (최근 5개)
│
└─ 메인 콘텐츠 (탭 방식)
   ├─ [탭1] 전체현황
   │  ├─ KPI 카드 (총 호출부호, 위험도별 3개, 상태별 2개)
   │  └─ 호출부호 목록 테이블 (20개, 필터, 페이지)
   │
   ├─ [탭2] 항공사조치
   │  ├─ 항공사별 현황 테이블 (조치율 색상)
   │  ├─ 드릴다운: 호출부호-조치 매핑
   │  └─ Excel 내보내기 버튼
   │
   └─ [탭3] 통계
      ├─ KPI 카드 (4개: 총/미조치/진행중/완료)
      ├─ 차트 (위험도별, 항공사별)
      └─ 통계 테이블 (항공사별 상세)
```

### 4.2 왼쪽 사이드 메뉴 (상세)

```
┌─────────────────────────┐
│   엑셀 업로드            │
├─────────────────────────┤
│ 📁 파일 선택 또는 드래그 │
│    (Drop files here)    │
├─────────────────────────┤
│ ⏳ 처리 중... 45%        │  (업로드 중일 때만 표시)
├─────────────────────────┤
│ ✅ 업로드 완료           │
│    추가: 15개            │
│    수정: 8개             │
│    실패: 2개             │  (완료 후)
├─────────────────────────┤
│ 📋 업로드 이력           │
│ • 2026-02-22 10:30      │
│   (150 rows, 5 failed)  │
│ • 2026-02-21 14:15      │
│   (200 rows, 0 failed)  │
│ • ...                   │
└─────────────────────────┘
```

### 4.3 탭별 레이아웃

#### 탭1: 전체현황
```
┌─────────────────────────────────────────────────┐
│         유사호출부호 등록 현황                    │
├─────────────────────────────────────────────────┤
│ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ │
│ │  총 호출부호 │ │   매우높음   │ │     높음     │ │
│ │    245개    │ │    89개     │ │    120개    │ │
│ └─────────────┘ └─────────────┘ └─────────────┘ │
│ ┌─────────────┐ ┌─────────────┐                 │
│ │     낮음     │ │   진행중    │                 │
│ │    36개     │ │    156개    │                 │
│ └─────────────┘ └─────────────┘                 │
├─────────────────────────────────────────────────┤
│ 호출부호 목록                                    │
│ 필터: [항공사 ▼] [위험도 ▼] [상태 ▼]            │
├─────────────────────────────────────────────────┤
│ 항공사 │ 호출부호 쌍    │ 위험도 │ 상태 │ 등록일 │
├─────────────────────────────────────────────────┤
│ KAL  │ KAL852 ↔ AAR852 │ 높음  │ 진행중│ 02-22 │
│ AAR  │ AAR501 ↔ CCA501 │ 낮음  │ 완료 │ 02-21 │
│ ...                                             │
└─────────────────────────────────────────────────┘
```

#### 탭2: 항공사조치
```
┌─────────────────────────────────────────────────┐
│         항공사 조치 현황                         │
├─────────────────────────────────────────────────┤
│ 항공사 │호출부호│ 조치율 │대기│진행│완료│상태   │
├─────────────────────────────────────────────────┤
│ OZ    │  12개  │ 75%  │ 3  │ 6 │ 3 │ 🟡 양호│
│ LJ    │   8개  │ 50%  │ 4  │ 4 │ 0 │ 🔴주의│
│ KAL   │  15개  │ 93%  │ 1  │ 0 │14 │ 🟢우수│
│ AAR   │   6개  │ 33%  │ 4  │ 2 │ 0 │ 🔴주의│
│ ...                                            │
├─────────────────────────────────────────────────┤
│ [Excel 내보내기]                                │
└─────────────────────────────────────────────────┘
```

#### 탭3: 통계
```
┌─────────────────────────────────────────────────┐
│              통계 분석                          │
├─────────────────────────────────────────────────┤
│ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────┐ │
│ │ 총호출부호│ │ 미조치   │ │ 진행중   │ │ 완료 │ │
│ │  245개   │ │  (12%)   │ │ (36%)    │ │(52%)│ │
│ │         │ │  29개    │ │  88개    │ │127개│ │
│ └──────────┘ └──────────┘ └──────────┘ └──────┘ │
├─────────────────────────────────────────────────┤
│  [위험도별 현황]          [항공사별 조치율]      │
│  📊 막대 차트            📊 가로 막대 차트       │
│   매우높음: 89개          KAL: 93% ████████░    │
│   높음: 120개             OZ: 75% ███████░░░    │
│   낮음: 36개              LJ: 50% █████░░░░░    │
│                          ...                   │
├─────────────────────────────────────────────────┤
│ 항공사별 상세 통계                              │
│ 항공사│호출부호│조치율│평균대응시간│최근업로드 │
├─────────────────────────────────────────────────┤
│ KAL  │ 15개  │ 93% │ 5.2일     │ 02-22      │
│ OZ   │ 12개  │ 75% │ 7.8일     │ 02-21      │
│ ...                                            │
└─────────────────────────────────────────────────┘
```

---

## 5. 데이터 흐름 (Data Flow)

### 5.1 엑셀 업로드 흐름

```
1. 관리자가 Excel 파일 드래그&드롭
   ↓
2. POST /api/admin/uploads (파일 업로드)
   ↓
3. 서버: 파일 파싱 → DB 삽입/업데이트
   - 호출부호 마스터 업데이트
   - 항공사에 즉시 공개 (공개 API: GET /api/callsigns)
   ↓
4. 응답: {success_count, updated_count, failed_count, errors}
   ↓
5. UI 업데이트:
   - 결과 요약 카드 표시
   - 업로드 이력에 기록
   - 탭1 호출부호 테이블 새로고침
   ↓
6. 항공사 대시보드:
   - GET /api/callsigns 호출 (자동 갱신 또는 새로고침)
   - 새 호출부호 표시 시작
```

### 5.2 데이터 조회 흐름

```
항공사조치 탭:
GET /api/admin/statistics?type=airline
→ 각 항공사별:
   - 총 호출부호 수 (count)
   - 조치율 (completed / total)
   - pending, in_progress, completed 개수
→ 조치율 기반 정렬 + 색상 코딩

통계 탭:
GET /api/admin/statistics?type=summary
→ 전체 KPI:
   - 총 호출부호
   - 상태별 분포 (pending/in_progress/completed)
→ GET /api/admin/statistics?type=chart
   - 위험도별 현황
   - 항공사별 조치율 (최근 30일 기준)
```

---

## 6. API 엔드포인트 (Endpoint Design)

### 6.1 기존 API 활용

```
GET /api/callsigns?limit=20&offset=0&airlineId=*&riskLevel=*&status=*
  → 호출부호 목록 (전체현황 탭)

GET /api/actions?limit=100&status=*&airlineId=*
  → 조치 데이터 (항공사조치 탭)

POST /api/admin/uploads (기존)
  → 엑셀 업로드 처리
```

### 6.2 신규 API

```
GET /api/admin/statistics?type=airline
  → 항공사별 현황 {
      airline_id, airline_code, airline_name_ko,
      total_callsigns, pending, in_progress, completed, completion_rate
    }[]

GET /api/admin/statistics?type=summary
  → 전체 요약 {
      total_callsigns,
      by_risk_level: {매우높음, 높음, 낮음},
      by_status: {pending, in_progress, completed}
    }

GET /api/admin/uploads/history?limit=5
  → 업로드 이력 {
      id, file_name, uploaded_at, total_rows, success_count, failed_count
    }[]

GET /api/admin/callsigns/export (Excel 다운로드)
  → .xlsx 파일 (항공사별 현황)
```

---

## 7. 기술 스택 & 아키텍처

### 7.1 프로젝트 레벨
- **Level**: Dynamic (fullstack BaaS)
- **Framework**: Next.js 14 App Router
- **State**: Zustand (auth) + TanStack Query v5 (server state)
- **Styling**: Tailwind CSS
- **차트**: Recharts (가볍고 React 최적화)
- **Excel**: SheetJS (기존 사용)

### 7.2 폴더 구조

```
src/
├─ app/
│  └─ admin/
│     ├─ callsign-mgmt-v1/
│     │  └─ page.tsx          (메인 페이지: 탭 + 왼쪽 사이드)
│     └─ api/
│        └─ admin/
│           └─ statistics/
│              └─ route.ts    (통계 API)
│
├─ components/
│  ├─ callsign-mgmt-v1/
│  │  ├─ Tabs.tsx            (탭 컨테이너)
│  │  ├─ OverviewTab.tsx      (전체현황)
│  │  ├─ ActionsTab.tsx       (항공사조치)
│  │  ├─ StatisticsTab.tsx    (통계)
│  │  ├─ StatisticsChart.tsx  (Recharts)
│  │  └─ Sidebar.tsx          (왼쪽 사이드)
│  └─ uploads/
│     ├─ FileUploadZone.tsx   (드래그&드롭)
│     ├─ UploadResult.tsx     (결과 요약)
│     └─ UploadHistory.tsx    (이력)
│
└─ lib/
   └─ constants.ts           (ROUTES 업데이트)
```

### 7.3 컴포넌트 구조

```
<CallsignMgmtV1Page>
├─ <Sidebar>
│  ├─ <FileUploadZone>
│  ├─ <UploadResult>
│  └─ <UploadHistory>
└─ <Tabs>
   ├─ <OverviewTab>
   │  ├─ KPI Cards (5개)
   │  └─ CallsignTable
   ├─ <ActionsTab>
   │  ├─ AirlineTable
   │  └─ Excel Export
   └─ <StatisticsTab>
      ├─ KPI Cards (4개)
      ├─ StatisticsChart (2개)
      └─ DetailTable
```

---

## 8. 구현 우선순위 (Implementation Order)

### Phase 1: 기본 구조 (Day 1)
- [ ] 상수 업데이트 (ROUTES.CALLSIGN_MGT_V1)
- [ ] 상단 메뉴에 링크 추가
- [ ] 페이지 스켈레톤 생성 (`/admin/callsign-mgmt-v1`)
- [ ] 탭 레이아웃 구현

### Phase 2: 왼쪽 사이드 메뉴 (Day 1-2)
- [ ] FileUploadZone 컴포넌트
- [ ] UploadResult 컴포넌트
- [ ] UploadHistory 컴포넌트
- [ ] 업로드 로직 통합

### Phase 3: 전체현황 탭 (Day 2)
- [ ] KPI 카드 (5개)
- [ ] CallsignTable (필터/페이지)
- [ ] 데이터 연결 (useCallsigns hook)

### Phase 4: 항공사조치 탭 (Day 2-3)
- [ ] AirlineTable (조치율 색상)
- [ ] 드릴다운 로직
- [ ] Excel 내보내기

### Phase 5: 통계 탭 (Day 3)
- [ ] KPI 카드 (4개)
- [ ] Recharts 통합
- [ ] 통계 API 연결

### Phase 6: 검증 & 최적화 (Day 4)
- [ ] 성능 최적화
- [ ] UX 개선
- [ ] TypeScript 검증

---

## 9. 성공 기준 (Success Criteria)

### 기능 검증
- [x] 상단 메뉴 "유사호출부호1" 클릭 → 페이지 로드
- [x] 왼쪽 사이드 엑셀 업로드 작동
- [x] 3개 탭 모두 데이터 표시
- [x] 필터/정렬 기능 동작
- [x] Excel 내보내기 다운로드

### 기술 검증
- [x] TypeScript 에러 0개
- [x] `npm run build` 성공
- [x] 콘솔 에러 없음
- [x] 응답 시간 < 2초

### UX 검증
- [x] 한국어 완전 지원
- [x] 색상 코딩 명확
- [x] 터치 포인트 명확

---

## 10. 위험 요소 & 대응 (Risks & Mitigation)

| 위험 | 영향 | 확률 | 대응 |
|-----|------|------|-----|
| 통계 API 응답 지연 | 탭3 로딩 느림 | 중 | 캐싱(60초 staleTime) + 백그라운드 갱신 |
| 엑셀 파일 형식 변경 | 업로드 실패 | 낮 | 에러 메시지 + 필터링 로직 |
| 항공사 데이터 불일치 | 통계 부정확 | 낮 | DB 제약조건 + 검증 로직 |
| Recharts 번들 크기 증가 | 빌드 용량 증가 | 중 | Dynamic import 또는 간단한 차트 라이브러리 |

---

## 11. 예상 일정 (Timeline)

**총 기간: 3-4일**

- Day 1: 기본 구조 + 왼쪽 사이드 (50%)
- Day 2: 전체현황 + 항공사조치 (50%)
- Day 3: 통계 탭 (100%)
- Day 4: 검증 & 미세 조정

---

## 12. 버전 이력 (Version History)

| 버전 | 날짜 | 변경 | 상태 |
|------|------|------|------|
| 1.0 | 2026-02-22 | 초안 작성 - 임시 메뉴 기반 관리자 대시보드 계획 | 계획 |

---

## 13. 부록: 정의 (Appendix: Definitions)

**조치율 (Completion Rate)**
= (완료된 조치 수) / (총 조치 수) × 100%

**상태 색상 코딩**
- 🟢 초록 (80%+): 우수 (Excellence)
- 🟡 황색 (50-80%): 양호 (Good)
- 🔴 빨강 (<50%): 주의 (Warning)

**즉시 공개 (Immediate Publishing)**
= 엑셀 업로드 완료 후 항공사 대시보드에서 새 호출부호 즉시 조회 가능
